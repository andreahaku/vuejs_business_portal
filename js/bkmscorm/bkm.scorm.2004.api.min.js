function Initialize(e){if(AppendToLog("bkm.scorm.2004.api event log",""),AppendToLog("--------------------------------------------------------------------------",""),AppendToLog("Initialize","iParam = "+e),result="false",_terminatedState)return setCurrentErrorCode("CONTENT_INSTANCE_TERMINATED"),AppendToLog("Initialize","return = "+result),result;if(_terminatedState=!1,_terminateCalled=!1,_scoVer2=!1,_initializedState)setCurrentErrorCode("ALREADY_INITIALIZED");else if(_debugApiCallsOnly)AppendToLog("Initialize","_debugApiCallsOnly = "+_debugApiCallsOnly),setDefaultLmsDomElementValues(),result="true";else if(setParameterError(e),_currentErrorCode==NO_ERROR)if(result=xmlhttpRequest("initialize",""),console.log(result),_currentErrorCode==NO_ERROR){if("false"==result)setLmsLastError();else if(setDefaultLmsDomElementValues(),"true"!=result){if(LMSSetDomElementValues(result),-1!=result.indexOf("cmi.entry=resume")){var r=xmlhttpRequest("getsuspenddata","");if(AppendToLog("Get Suspend Data ",result),_currentErrorCode==NO_ERROR){""!=r&&setCacheValue("cmi.suspend_data",r);var t=xmlhttpRequest("getlocation","");AppendToLog("Get Location ",t),_currentErrorCode==NO_ERROR&&("null"!=t&&setCacheValue("cmi.location",t),_currentErrorCode==NO_ERROR&&(null!=r&&""!=r||null!=t&&""!=t)&&(result=xmlhttpRequest("getcompletionstatus",""),AppendToLog("Get Completion Status ",result),_currentErrorCode==NO_ERROR&&(setCacheValue("cmi.completion_status",result),result=xmlhttpRequest("getsuccessstatus",""),AppendToLog("Get Success Status ",result),_currentErrorCode==NO_ERROR&&"null"!=result&&setCacheValue("cmi.success_status",result))))}}result="true"}}else result="false";return"true"==result&&(_initializedState=!0,keepAliveStart()),AppendToLog("Initialize","return = "+result),result}function GetValue(e){return result="",setCurrentErrorCode("NO_ERROR"),_terminatedState&&setCurrentErrorCode("GET_AFTER_TERMINATE"),isInitialized()||setCurrentErrorCode("GET_BEFORE_INIT"),(""==e||"undefined"==typeof e||null==e)&&setCurrentErrorCode("GENERAL_ARGUMENT_ERROR"),isLmsWriteOnlyDomElement(e)&&setCurrentErrorCode("DATA_MODEL_VALUE_IS_WRITEONLY"),"cmi._version"==e&&_currentErrorCode==NO_ERROR&&(result=_cmiversion),"cmi.completion_status"==e&&_currentErrorCode==NO_ERROR&&(completionThreshold=getCacheValue("cmi.completion_threshold"),"undefined"!=completionThreshold&&(progressMeasure=getCacheValue("cmi.progress_measure"),"undefined"!=progressMeasure?progressMeasure>=completionThreshold?result="completed":result="incomplete":result="unknown")),console.log(_currentErrorCode),"cmi.success_status"==e&&_currentErrorCode==NO_ERROR&&(scaledPassingScore=getCacheValue("cmi.scaled_passing_score"),"undefined"!=scaledPassingScore&&(scoreScaled=getCacheValue("cmi.score.scaled"),"undefined"!=scoreScaled?scoreScaled>=scaledPassingScore?result="passed":result="failed":result="unknown")),"cmi.interactions._count"==e&&_currentErrorCode==NO_ERROR&&(_interactionCount++,result=""+_interactionCount),""==result&&_currentErrorCode==NO_ERROR&&(0==e.indexOf("cmi.")?(cacheVal=getCacheValue(e),null!=cacheVal&&"undefined"!=cacheVal?result=cacheVal:setCurrentErrorCode("DATA_MODEL_VALUE_NOT_INITIALIZED")):setCurrentErrorCode("UNDEF_DATA_MODEL_ELEMENT")),AppendToLog("GetValue","iDomElement = "+e+", return = "+result),result}function SetValue(e,r){return result="false",setCurrentErrorCode("NO_ERROR"),_terminatedState&&setCurrentErrorCode("SET_AFTER_TERMINATE"),isInitialized()||setCurrentErrorCode("SET_BEFORE_INIT"),(""==e||"undefined"==typeof e||null==e)&&setCurrentErrorCode("GENERAL_ARGUMENT_ERROR"),isLmsReadOnlyDomElement(e)&&setCurrentErrorCode("DATA_MODEL_VALUE_IS_READONLY"),_currentErrorCode==NO_ERROR&&(setCacheValue(e,r),result="true"),AppendToLog("SetValue","iDomElement = "+e+" = "+r+", return = "+result),result}function Commit(e){return AppendToLog("Commit","iParam = "+e),result="false",setCurrentErrorCode("NO_ERROR"),_terminatedState&&setCurrentErrorCode("COMMIT_AFTER_TERMINATE"),isInitialized()||setCurrentErrorCode("COMMIT_BEFORE_INIT"),setParameterError(e),_currentErrorCode==NO_ERROR&&(result=sendLmsData(!0)),AppendToLog("Commit","return = "+result),"true"}function Terminate(e){return AppendToLog("Terminate","iParam = "+e),_terminateCalled=!0,result="false",setCurrentErrorCode("NO_ERROR"),_terminatedState&&setCurrentErrorCode("TERMINATE_AFTER_TERMINATE"),isInitialized()||setCurrentErrorCode("TERMINATE_BEFORE_INIT"),setParameterError(e),_currentErrorCode==NO_ERROR&&(result=sendLmsData(!0),sendCommand("finish"),_terminatedState=!0,_initializedState=!1,keepAliveStop(),result="true"),AppendToLog("Terminate","return = "+result),result}function GetLastError(){return AppendToLog("GetLastError","return = "+_currentErrorCode),setCurrentErrorCode("NO_ERROR"),_currentErrorCode+""}function GetErrorString(e){return AppendToLog("GetErrorString","iErrCode = "+e),result="",setCurrentErrorCode("NO_ERROR"),""==e||null==e||"undefined"==typeof e?(setCurrentErrorCode("GEN_ARGUMENT_ERROR"),AppendToLog("GetErrorString","return = "+result),result):("undefined"!=typeof getErrorDefString(e)&&(result=getErrorDefString(e).substr(0,255)),AppendToLog("GetErrorString","return = "+result),result)}function GetDiagnostic(e){return AppendToLog("GetDiagnostic","iDiagnosticFeatures = "+e),AppendToLog("GetDiagnostic","return = "),setCurrentErrorCode("NO_ERROR"),""}function isInitialized(){return!_initializedState&&_scoVer2&&setCurrentErrorCode("GEN_GET_FAILURE"),_initializedState}function LMSSetDomElementValues(e){for(var r=e.split(";"),t=0;t<r.length;t++){var n=r[t].split("=");setCacheValue(n[0],n[1]),AppendToLog("LMSSetValue",n[0]+" = "+n[1])}}function setDefaultLmsDomElementValues(){setCacheValue("cmi.learner_id",_learnerId,DME_READ_ONLY),setCacheValue("cmi.learner_name",_learnerName,DME_READ_ONLY),addLmsWriteOnlyDomElementName("cmi.comments_from_learner"),setCacheValue("cmi.comments_from_lms","",DME_READ_ONLY),setCacheValue("cmi.credit","credit",DME_READ_ONLY),setCacheValue("cmi.entry","ab-initio",DME_READ_ONLY),addLmsWriteOnlyDomElementName("cmi.exit"),setCacheValue("cmi.interactions._children",_interactionProperties,DME_READ_ONLY),setCacheValue("cmi.interactions._count","0",DME_READ_ONLY),setCacheValue("cmi.launch_data","",DME_READ_ONLY),setCacheValue("cmi.learner_preference._children","audio_level,language,delivery_speed,audio_captioning",DME_READ_ONLY),setCacheValue("cmi.learner_preference.audio_level","3"),setCacheValue("cmi.learner_preference.language",""),setCacheValue("cmi.learner_preference.delivery_speed","1",DME_READ_ONLY),setCacheValue("cmi.learner_preference.audio_captioning","0"),setCacheValue("cmi.location",""),setCacheValue("cmi.max_time_allowed","1000000000",DME_READ_ONLY),setCacheValue("cmi.mode","normal",DME_READ_ONLY),setCacheValue("cmi.objectives._children","id,score,success_status,completion_status,progress_measure,description",DME_READ_ONLY),setCacheValue("cmi.objectives._count","0",DME_READ_ONLY),setCacheValue("cmi.scaled_passing_score","0",DME_READ_ONLY),addLmsWriteOnlyDomElementName("cmi.session_time"),setCacheValue("cmi.success_status","unknown"),setCacheValue("cmi.suspend_data",""),setCacheValue("cmi.time_limit_action","continue,no message",DME_READ_ONLY),setCacheValue("cmi.total_time","0",DME_READ_ONLY),setCacheValue("cmi.interactions","")}function sendLmsData(e){AppendToLog("sendLmsData","Param = scorm2004 = "+(e?e:"false")),result="false";var r="";if(setLmsValue("cmi.suspend_data"),e){setLmsValue("cmi.completion_status"),setLmsValue("cmi.success_status"),setLmsValue("cmi.score.raw"),setLmsValue("cmi.score.max"),setLmsValue("cmi.score.min"),setLmsValue("cmi.score.scaled"),setLmsValue("cmi.session_time"),setLmsValue("cmi.location");for(var t=_interactionProperties.split(","),n=0;_interactionCount>=n;n++)for(var o=0;o<t.length;o++){var i="cmi.interactions."+n+"."+t[o],a=getCacheValue(i);if("undefined"!=typeof a)r+=i+"="+a,r+=o==t.length-1?"$%$":"$&$";else if(o==t.length-1){var s=r.substr(r.length-3);console.log(s),"$&$"===s&&(r=r.substring(0,r.length-3),r+="$%$")}}""!=r&&(console.log("Interactions STRING"),r=Base64.encode(r),setLmsValue("cmi.interactions",r))}else{var l=getCacheValue("cmi.core.lesson_status");"completed"==l||"passed"==l||"failed"==l?setLmsValue("cmi.completion_status","completed"):"incomplete"==l?setLmsValue("cmi.completion_status",l):setLmsValue("cmi.completion_status","unknow"),"passed"==l||"failed"==l?setLmsValue("cmi.success_status",l):setLmsValue("cmi.success_status","unknow"),setLmsValue("cmi.score.raw",getCacheValue("cmi.core.score.raw")),setLmsValue("cmi.score.max",getCacheValue("cmi.core.score.max")),setLmsValue("cmi.score.min",getCacheValue("cmi.core.score.min")),setLmsValue("cmi.session_time",getCacheValue("cmi.core.session_time")),setLmsValue("cmi.location",getCacheValue("cmi.core.lesson_location"));for(var t=_interactionProperties_1_2.split(","),n=0;_interactionCount>=n;n++){for(var o=0;o<t.length;o++){var u="cmi.interactions."+n+".",c=t[o];"time"==t[o]&&(c="timestamp"),"student_response"==t[o]&&(c="learner_response"),"text"==t[o]&&(c="description");var a=getCacheValue(u+t[o]);if("undefined"!=typeof a)r+=u+""+c+"="+a,r+=o==t.length-1?"$%$":"$&$";else if(o==t.length-1){var s=r.substr(r.length-3);"$&$"===s&&(r=r.substring(0,r.length-3),r+="$%$")}}n==_interactionCount&&""!=r&&(r=r.substring(0,r.length-3))}_interactionCount=0,""!=r&&(console.log("Interactions STRING:"),r=Base64.encode(r),setLmsValue("cmi.interactions",r))}return _debugApiCallsOnly?"true":(result=xmlhttpRequest("commit",_lmsDataObj),_currentErrorCode==NO_ERROR&&"true"!=result&&(setLmsLastError(),result=!1),result)}function setLmsValue(e,r){null!=r?(_lmsDataObj[e]=r,AppendToLog("setLmsValue","iDomElement = "+e+", iValue = "+r)):(_lmsDataObj[e]=getCacheValue(e),AppendToLog("setLmsValue","iDomElement = "+e+", iValue = "+getCacheValue(e)))}function setCacheValue(e,r,t){_cacheObj[e]=r,t==DME_WRITE_ONLY&&addLmsWriteOnlyDomElementName(e),t==DME_READ_ONLY&&addLmsReadOnlyDomElementName(e)}function getCacheValue(e){return _cacheObj[e]}function addLmsWriteOnlyDomElementName(e){_lmsWriteOnlyDomElementNamesObj[e]=""}function addLmsReadOnlyDomElementName(e){_lmsReadOnlyDomElementNamesObj[e]=""}function isLmsWriteOnlyDomElement(e){return""==_lmsWriteOnlyDomElementNamesObj[e]?!0:!1}function isLmsReadOnlyDomElement(e){return""==_lmsReadOnlyDomElementNamesObj[e]?!0:!1}function setParameterError(e){""!=e&&setCurrentErrorCode("GEN_ARGUMENT_ERROR")}function setLmsLastError(){result=xmlhttpRequest("getLastError",""),null!=result&&"undefined"!=typeof result&&(-1!=result.indexOf("[#]")?setCurrentErrorCode(result.split("[#]")[0],result.split("[#]")[1]):setCurrentErrorCode("LMS_GET_ERROR_EXCEPTION",result))}function setCurrentErrorCode(iErrCodeName,iNativeErrString){return _currentErrorCode=eval(iErrCodeName),_currentErrorCode==NO_ERROR?void(_currentErrorString=NO_ERROR_STRING):(_currentErrorString="undefined"!=typeof iNativeErrString?iNativeErrString:eval(iErrCodeName+"_STRING"),condition="undefined"==typeof getErrorDefString(_currentErrorCode)&&"undefined"!=typeof iNativeErrString,condition&&(_errorDefObj[_currentErrorCode]=iNativeErrString),void AppendToLog("setCurrentErrorCode","scorm code = "+_currentErrorCode+", desc = "+_currentErrorString))}var API_1484_11=this,_cmiversion="1.0",_terminatedState=!1,_initializedState=!1,_terminateCalled=!1,_scoVer2=!1,_currentErrorCode=NO_ERROR,_currentErrorString=NO_ERROR_STRING,_cacheObj=new Object,_lmsDataObj=new Object,_lmsWriteOnlyDomElementNamesObj=new Object,_lmsReadOnlyDomElementNamesObj=new Object,_interactionCount=-1,_interactionProperties="id,type,objective,objectives,timestamp,correct_responses.0.pattern,weighting,learner_response,result,latency,description",DME_WRITE_ONLY="DME_WRITE_ONLY",DME_READ_ONLY="DME_READ_ONLY",_debugApiCallsOnly=!1;"string"==typeof _debug&&(_debugApiCallsOnly=-1!=_debug.indexOf(DEBUG_API_CALL_ONLY));